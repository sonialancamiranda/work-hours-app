
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Espace Manager ‚Äì A Master‚Äôs Cleaning</title>

<!-- Librairie Excel -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f7f7f7;
  padding: 20px;
}

.container {
  max-width: 900px;
  margin: auto;
  background: white;
  padding: 20px;
  border-radius: 10px;
}

h1 {
  text-align: center;
}

button {
  padding: 10px 20px;
  font-size: 16px;
  cursor: pointer;
  margin-top: 20px;
}

.hidden {
  display: none;
}
</style>
</head>

<body>

<div class="container">

  <h1>üîê Espace Manager</h1>

  <!-- LOGIN -->
  <div id="login">
    <p>Mot de passe manager :</p>
    <input type="password" id="password">
    <br><br>
    <button onclick="checkPassword()">Entrer</button>
    <p id="error" style="color:red;"></p>
  </div>

  <!-- CONTENU MANAGER -->
  <div id="managerContent" class="hidden">
    <h2>A Master‚Äôs Cleaning</h2>
    <p>Export des heures encod√©es</p>

    <button onclick="exportExcel()">üìä Export Excel</button>
  </div>

</div>

<script>
const MANAGER_PASSWORD = "Kes131577@284666577";

function checkPassword() {
  const input = document.getElementById("password").value;
  if (input === MANAGER_PASSWORD) {
    document.getElementById("login").style.display = "none";
    document.getElementById("managerContent").classList.remove("hidden");
  } else {
    document.getElementById("error").innerText = "Mot de passe incorrect";
  }
}

function exportExcel() {
  const data = JSON.parse(localStorage.getItem("workHours")) || [];

  if (data.length === 0) {
    alert("Aucune donn√©e √† exporter");
    return;
  }

  const worksheet = XLSX.utils.json_to_sheet(data);
  const workbook = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(workbook, worksheet, "Heures");

  XLSX.writeFile(workbook, "heures_travail.xlsx");
}
</script>

</body>
</html>

