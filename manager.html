<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Espace Manager ‚Äì A Master‚Äôs Cleaning</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  padding: 30px;
}

.container {
  max-width: 900px;
  margin: auto;
  background: white;
  padding: 25px;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

h1 {
  text-align: center;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}

th {
  background: #f0f0f0;
}

button {
  margin-top: 20px;
  padding: 10px 15px;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container">
  <h1>üîê Espace Manager</h1>
  <p>Vue globale des heures encod√©es</p>

  <table>
    <thead>
      <tr>
        <th>Travailleur</th>
        <th>Heures prest√©es</th>
        <th>Vacances</th>
        <th>Jours f√©ri√©s</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody id="dataTable">
      <tr>
        <td colspan="5">Aucune donn√©e trouv√©e</td>
      </tr>
    </tbody>
  </table>

  <button onclick="exportExcel()">üì§ Export Excel</button>
</div>

<script>
function loadData() {
  const data = JSON.parse(localStorage.getItem("workHoursData")) || [];
  const table = document.getElementById("dataTable");
  table.innerHTML = "";

  if (data.length === 0) {
    table.innerHTML = "<tr><td colspan='5'>Aucune donn√©e trouv√©e</td></tr>";
    return;
  }

  let totalWork = 0, totalVac = 0, totalFer = 0;

  data.forEach(item => {
    totalWork += item.work;
    totalVac += item.vacation;
    totalFer += item.holiday;

    table.innerHTML += `
      <tr>
        <td>${item.name}</td>
        <td>${item.work}</td>
        <td>${item.vacation}</td>
        <td>${item.holiday}</td>
        <td>${item.work + item.vacation + item.holiday}</td>
      </tr>
    `;
  });

  table.innerHTML += `
    <tr style="font-weight:bold;background:#eee">
      <td>TOTAL</td>
      <td>${totalWork}</td>
      <td>${totalVac}</td>
      <td>${totalFer}</td>
      <td>${totalWork + totalVac + totalFer}</td>
    </tr>
  `;
}

function exportExcel() {
  const data = JSON.parse(localStorage.getItem("workHoursData")) || [];
  if (data.length === 0) {
    alert("Aucune donn√©e √† exporter");
    return;
  }

  let csv = "Travailleur,Heures prest√©es,Vacances,Jours f√©ri√©s,Total\n";
  data.forEach(d => {
    csv += `${d.name},${d.work},${d.vacation},${d.holiday},${d.work+d.vacation+d.holiday}\n`;
  });

  const blob = new Blob([csv], { type: "text/csv" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "heures_mensuelles.csv";
  a.click();
}

loadData();
</script>

</body>
</html>


